<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <title>成绩信息</title>
    <style type="text/css">
        #a1 {
            width: 30%;
            height: 90px;
            float: left;
        }

        #a2 {
            width: 55%;
            height: 40px;
            float: left;
            text-align: right;
            padding-top: 35px;
            z-index: 1;
        }

        #t1 {
            width: 100%;
            height: 500px;
        }

        #table {
            width: 100%;
            text-align: center;
            border-color: #6495ED;
            border: 0px solid #6495ED;
        }

        .table {
            width: 80%;
            float: left;
            height: 400px;
        }

        #addinfo {
            width: 400px;
            height: 400px;
            text-align: left;
            float: left;
            box-shadow: 0px 0px 35px 0px #6495ED;
            z-index: 3;
            background-color: white;
            position: absolute;
            left: 25%;
            top: 18%;
            border-radius: 27px 0px 27px 27px;
        }

        th {
            border: 1px solid ghostwhite;
        }

        th {
            height: 40px;
            background-color: #6495ED;
        }

        td {
            border: 1px solid floralwhite;
            height: 30px;
        }

        tr:hover {
            background-color: #999999;
            height: 37px;
        }

        #td {
            border: 3px solid #000000;
            width: 60px;
            height: 40px;
            background-color: #6495ED;
        }

        #add {
            width: 140px;
            height: 40px;
            text-decoration: none;
            background-color: #6495ED;
            border: 3px solid #000000;
            color: #F0F8FF;
            padding: 10px 10px 10px 10px;
            margin-right: 10%;
            border-radius: 6px 6px 6px 6px;
        }

        #add:hover {
            color: #000000;
        }

        select {
            height: 40px;
            border: 2px solid #000000;
            border-radius: 3px 3px 3px 3px;
            margin-right: 40px;
            margin-left: 20px;
        }

        .a10 .ss1 {
            height: 40px;
            border: 2px solid #000000;
            border-radius: 3px 3px 3px 3px;
            width: 80px;
            margin-right: 40px;
            margin-left: 20px;
            font-size: 16px;
        }

        #form1 {
            font-size: larger;
            padding-left: 20px;
            text-align: center;
        }

        input {
            width: 65%;
            height: 25px;
            border-radius: 6px 6px 6px 6px;
            margin-top: 10px;
        }

        #btn_update, #btn_ext, #btn_add {
            width: 120px;
            height: 40px;
            border-radius: 6px 6px 6px 6px;
            margin: 0 auto;
            background-color: #6495ED;
        }

        #btn_add {
            color: white;
        }

        #btn_ext {
            color: white;
        }

        #btn_add :hover {
            color: #999999;
        }

        #btn_ext :hover {
            color: antiquewhite;
        }

        #xiu {
            border-radius: 3px 3px 3px 3px;
            border: 1px solid bisque;
            padding: 5px;
            box-shadow: 0px 0px 30px 0px #DCDCDC;
            background-color: coral;
        }

        #xiu:hover {
            color: #BD0A01;
        }

        #xiu2 {
            border-radius: 3px 3px 3px 3px;
            border: 1px solid bisque;
            padding: 5px;
            box-shadow: 0px 0px 30px 0px #DCDCDC;
            background-color: springgreen;
        }

        #xiu2:hover {
            color: #BD0A01;
        }

        #h4 {
            width: 94%;
            float: left;
            padding-top: 15px;
            font-size: larger;
            height: 30px;
            padding-left: 0px;
            border-radius: 0px 0px 50% 50%/0px 0px 40px 40px;
            background-color: #6495ED;
        }


        #h3 {
            width: 5%;
            float: right;
            height: 20px;
            padding: 0;
            text-align: right;
            margin: 0 auto;
        }

        /* #h2{width: 100%;float: left;height: 40px;border-radius: 0px 0px 50% 50%/0px 0px 30px 30px;background-color: #6495ED;} */
        #span1 {
            width: 20px;
            font-size: x-large;
            line-height: 10px;
        }

        #h3 :hover {
            background-color: #DCDCDC;
        }

        #aa2 {
            float: left;
            width: 15%;
        }

        #aa3 {
            width: 80%;
            height: 320px;
            float: left;
        }

        #shu {
            height: 320px;
        }

        .a10 .a9 {
            width: 70px;
            height: 20px;
            background-color: #fff;
            position: absolute;
            left: 200px;
            bottom: 0px;
        }

        .a10 {
            width: 100%;
            height: 50px;
            margin-top: 0px;
            background-color: #dcdcdc;
            float: left;
            font-size: larger;
            padding-left: 20px;
        }

        .dao {
            border-radius: 3px 3px 3px 3px;
            box-shadow: 0px 0px 30px 0px #DCDCDC;
            background: white;
            width: 70px;
            height: 40px;
            float: left;
            margin-right: 20px;
        }
        ::-webkit-scrollbar {
            width: 0px;
        }
    </style>
</head>
<body>
<div id="a1">
    <h2><font style="color: #6495ED;">~~成绩信息~~</font></h2>
</div>
<div id="a3">

</div>
<div id="text">
    <div id="a2" v-if="this.index1!=2">
        <input id="value" placeholder="输入试卷号"> </input>
        <a  type="button"  href="#"  @click="select()"  id="add">查找</a>
    </div>
    <div class="table" style="overflow:auto" >
        <table border="1" style="text-align:center" id="table" cellspacing="0">
            <tr>
                <th>试卷号</th>
                <th>试卷名称</th>
                <th>学号</th>
                <th>姓名</th>
                <th  v-if="index1!=2">班级码</th>
                <th>班级</th>
                <th>成绩</th>
                <th v-if="this.index1!=2">操作</th>
            </tr>

            <tr v-for=" (grade,index) in grade"  >
                <td>{{grade.paperid}}</td>
                <td>{{grade.id}}</td>
                <td>{{grade.number}}</td>
                <td>{{grade.name}}</td>
                <td  v-if="index1!=2">{{grade.banji}}</td>
                <td >{{grade.classname}}</td>
                <td>{{grade.chengji}}</td>


                <td v-if="index1!=2"  ><a  style="color:#6495ED;cursor: pointer;" @click="updata(index)" id="xiu">修改</a>&nbsp
                    <a style="color:chocolate;cursor:pointer;" @click="del(index);" id="xiu2">删除</a></td>
    </tr>


        </table>
    </div>
    <div id="addinfo" style="display: none;" title="点击鼠标以固定，滑动鼠标拖动">
        <!-- <div id="aa2">
    <img src="img/书本.jpg" align="right" height="400px" id="shu">
    </div> -->
        <!-- <div id="aa3"> -->
        <form action="" method="" id="form1">
            <center>
                <div id="h4"> <b>~~请添加信息~~</b></div></center><div id="h3">
            <span style=" color: black;cursor:pointer;" @click="hideAddInput()" id="span1">×</span>
        </div> <br>
            <input type="text" v-model="paperid" id="xuehao" placeholder="试卷号" disabled/>
            <br>
            <input type="text" v-model="id" id="name" placeholder="试卷名称" disabled/>
            <br><!--限制用户名只能用英文 下划线 或数字-->
            <input type="text" v-model="number" id="xueyuan" placeholder="学号" disabled/>
            <br>
            <input type="text" v-model="name" id="zhuanye" placeholder="请姓名" disabled/>
            <br>
            <input type="text" v-model="banji" id="banji" placeholder="请输入班级"  disabled/>
            <br>
            <input type="text" v-model="chengji" id="zhuanye" placeholder="成绩"/>
            <br>
            <hr width="90%" size="2" color="white">
            <center><div><input type="button" value="提交" @click="addInfo()" id="btn_add" >
                <!--                <input type="button" value="提交" onclick="updateInfo()" style="display:none" id="btn_update">-->
                <!-- <input type="button" value="取消" onclick="hideAddInput()" id="btn_ext"> --></div></center>
        </form>
    </div>
</div>
<script src="https://unpkg.com/vue@2/dist/vue.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<!--<script type="module" src="js/main.js"></script>-->
<script type="module">
    console.log("aaa")
    new Vue({
        el:"#text",
        data(){
            return{
                //  textname:""
                grade:[],
                paperid:"",
                id:"",
                number:"",
                name:"",
                chengji:"",
                banji:"",
                index1:''
            }},
        methods:{
            updata(index){
                var _this=this
                document.getElementById('addinfo').style="display:block-inline" ;
                // console.log(this.stu[index].number)
                this.paperid=this.grade[index].paperid
                this.id= this.grade[index].id
                this.number=this.grade[index].number
                this.name=this.grade[index].name
                this.banji=this.grade[index].banji
                this.chengji=this.grade[index].chengji
            },
            hideAddInput(){
                document.getElementById('addinfo').style="display:none" ;

            },
            del(index){
                var _this=this
                console.log("aabb")
                axios({
                    method: "post",
                    url: "http://localhost:8080/lunwen/del/delgrade",
                    changeOrigin:true,
                    data: {
                        number:this.grade[index].number,
                        paperid:this.grade[index].paperid
                    },
                    paramsSerializer: function (data) {
                        return qs.stringify(data, { arrayFormat: 'repeat' })
                    }
                }).then(function (req) {
                    console.log(req.data)
                    if(req.data==true){
                        alert("删除成功")
                        location.reload()
                    }else
                    {
                        alert("修改失败")
                    }
                })
            }
            ,
            addInfo(){
                var _this=this
                axios({
                    method: "post",
                    url: "http://localhost:8080/lunwen/rea25/updategrade",
                    changeOrigin:true,
                    data: {
                      paperid:  this.paperid,
                        id:this.id,
                        number:this.number,
                        name:this.name,
                       banji: this.banji,
                       chengji:this.chengji
                    },
                    paramsSerializer: function (data) {
                        return qs.stringify(data, { arrayFormat: 'repeat' })
                    }
                }).then(function (req) {
                    console.log(req.data)
                    if(req.data==true){
                        alert("修改成功")
                        location.reload()
                    }else
                    {
                        alert("修改失败")
                    }
                })
            },

            select()
            {
                var _this=this;
                var a=  document.getElementById("value").value;
                axios({
                    method: "post",
                    url: "http://localhost:8080/lunwen/rea25/gradeselect",
                    changeOrigin:true,
                    data: {
                        paperid:a
                    }

                }).then(function (req) {

                    _this.grade = req.data
                    console.log(req.data)

                }).catch(err=>{
                    if(req.data==0) {
                        console.log("err")
                    }
                })


            }
        }
        ,
        mounted() {
            var _this=this;
            console.log(this.name)
            axios({
                method: "post",
                url: "http://localhost:8080/lunwen/rea25/grade",
                changeOrigin:true,
                data:{
                   number:this.name,
                    index:this.index1
                }
            }).then(function (req) {

                _this.grade = req.data
                console.log(req.data)
            }).catch(err=>{
                if(req.data==0) {
                    console.log("err")
                }
            })

        },
        created() {
            var url = window.location.search;
            let _this=this
            let returl = new Object();
            if (url.indexOf("?") != -1) {
                let queryString = url.substr(1);
                let queryParams = queryString.split("&");
                for (let i = 0; i < queryParams.length; i++) {
                    let [key, value] = queryParams[i].split("=");
                    returl [key] = decodeURI(value);
                    //值需要使用 decodeURI() 函数对通过 escape() 或 url 编码过的字符串进行解码
                }}
            this.name= returl["name"]
            this.index1=returl["index"]
            console.log(returl)
            console.log( this.name)
            console.log(this.index1)
        }

    })

    // function select() {
    //     // var a = document.getElementById("value").value;
    //     // location.href = "demo1?number=" + a + "";
    //
    // //     var a=  document.getElementById("value").value;
    // // axios({
    // //
    // //     method: "get"
    //
    // // })
    //
    //
    // }

</script>
<script>
    window.onload = function(){
        var box = document.getElementById("addinfo");
        var box1=document.getElementById("h4");
        var box2=document.getElementById("aa2")
        box1.onmousedown = function(){
            document.onmousemove = function(event){
                event = event || window.event;
                var left = event.clientX;
                var top = event.clientY;
                box.focus();
                box.style.left = left +"px";
                box.style.top = top +"px";

                document.onmouseup = function(){
                    document.onmousemove = null;
                    document.onmouseup = null;
                };
                //        };document.onmousedown= function(){
                //                document.onmousemove = null;
                //                document.onmouseup = null;
                // };
            };
        };
    };
</script>
</body>
</html>
